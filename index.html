<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Truck Record System</title>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Truck Records">
    <meta name="theme-color" content="#1e40af">
    <meta name="description" content="Truck Record Management System - Track arrivals, handovers, and XDOCK records">
    
    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iNDAiIGZpbGw9IiMxZTQwYWYiLz4KPHN2ZyB4PSI0MCIgeT0iNDAiIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9IndoaXRlIj4KPHA+dGg+TTIwIDhoLTNWNmMwLTEuMS0uOS0yLTItMkg5Yy0xLjEgMC0yIC45LTIgMnYySDRjLTEuMSAwLTIgLjktMiAydjEwYzAgMS4xLjkgMiAyIDJoMTZjMS4xIDAgMi0uOSAyLTJWMTBjMC0xLjEtLjktMi0yLTJ6TTkgNmg2djJIOVY2ek0yMCAxOEg0VjEwaDMuNWwxLjUgMS41aDZsMS41LTEuNUgyMHY4eiIvPgo8L3N2Zz4KPC9zdmc+">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIwIDhoLTNWNmMwLTEuMS0uOS0yLTItMkg5Yy0xLjEgMC0yIC45LTIgMnYySDRjLTEuMSAwLTIgLjktMiAydjEwYzAgMS4xLjkgMiAyIDJoMTZjMS4xIDAgMi0uOSAyLTJWMTBjMC0xLjEtLjktMi0yLTJ6TTkgNmg2djJIOVY2ek0yMCAxOEg0VjEwaDMuNWwxLjUgMS41aDZsMS41LTEuNUgyMHY4eiIgZmlsbD0iIzFlNDBhZiIvPgo8L3N2Zz4K">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlRydWNrIFJlY29yZCBTeXN0ZW0iLAogICJzaG9ydF9uYW1lIjogIlRydWNrIFJlY29yZHMiLAogICJkZXNjcmlwdGlvbiI6ICJUcnVjayBSZWNvcmQgTWFuYWdlbWVudCBTeXN0ZW0gLSBUcmFjayBhcnJpdmFscywgaGFuZG92ZXJzLCBhbmQgWERPQ0sgcmVjb3JkcyIsCiAgInN0YXJ0X3VybCI6ICIuLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzFlNDBhZiIsCiAgInRoZW1lX2NvbG9yIjogIiMxZTQwYWYiLAogICJvcmllbnRhdGlvbiI6ICJwb3J0cmFpdCIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU1UZ3dJaUJvWldsbmFIUTlJakU0TUNJZ2RtbGxkMEp2ZUQwaU1DQXdJREU0TUNBME9EQWlJR1pwYkd3OUltNXZibVVpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrQ2p4eVpXTjBJSGRwWkhSb1BTSXhPREFpSUdobGFXZG9kRDBpTVRnd0lpQnllRDBpTkRBaUlHWnBiR3c5SWlNeE16UXdZV1lpTHo0S1BITjJaeUI0UFNJME1DSWdlVDBpTkRBaUlIZHBaSFJvUFNJeE1EQWlJR2hsYVdkb2REMGlNVEF3SWlCMmFXVjNRbTk0UFNJd0lEQWdNalFnTWpRaUlHWnBiR3c5SW5kb2FYUmxJajRLUEhCaGRHZ2daRDBpVFRJd0lEaG9MVE5XTm1Nd0xURXVNUzR1T1MweUxUSXRNa2c1WXkweExqRWdNQzB5SUM0NUxUSWdNbll5U0RSakxURXVNU0F3TFRJZ0xqbHRNaUF5ZGpFd1l6QWdNUzR4TGprdU1pQXlJRElvTVRZZ01TNHhJREFnTWkwdU9TMHlMVEo2VFRrZ05tZzJkakpJT1ZZMmVrMHlNQ0F4T0VnMFZqRXdhRE11TldneExqVWdNUzQxYURac01TNDFMVEV1TlVneU1IWTRlaUl2UGdvOEwzTjJaejRLUEM5emRtYytJZz09IiwKICAgICAgInNpemVzIjogIjE4MHgxODAiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfSwKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlOVEV5SWlCb1pXbG5hSFE5SWpVeE1pSWdkbWxsZDBKdmVEMGlNQ0F3SURRNE5DQTBPRFFpSUdacGJHdzlJbTV2Ym1VaUlIaHRiRzV6UFNKb2RIUndPaTh2ZDNkM0xuY3pMbTl5Wnk4eU1EQXdMM04yWnlJK0NqeHlaV04wSUhkcFpIUm9QU0kwT0RRaUlHaGxhV2RvZEQwaU5EZzBJaUJ5ZUQwaU9EQWlJR1pwYkd3OUlpTXhaVFF3WVdZaUx6NEtQSE4yWnlCNFBTSXhNakFpSUhrOUlqRXlNQ0lpSUhkcFpIUm9QU0l5TkRRaUlHaGxhV2RvZEQwaU1qUTBJaUIyYVdWM1FtOTRQU0l3SURBZ01qUWdNalFpSUdacGJHdzlJbmRvYVhSbElqNEtQSEJoZEdnZ1pEMGlUVEl3SURob0xUTldObU13TFRFdU1TMDVMVEl0TWkweVNEbGpMVEV1TVNBd0xUSWdMamt0TWlBemRqSkVORU10TVM0eElEQXRNaUF1T1MweUlESWdkakV3WXpBZ01TNHhMamt1T1NBeUlESWdNbWd4Tm1NeExqRWdNQ0F5TFM0NUlESXRNaTB5ZWswNUlEWm9Obll5U0RsV05tcE5NakFnTVRoSU5GWXhNR2d6TGpWc01TNDFJREV1TldnMmJERXVOUzB4TGpWSU1qQjJPSG9pSUdacGJHdzlJaU14WlRRd1lXWWlMejRLUEM5emRtYytJZz09IiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0KfQ==">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        secondary: '#059669',
                        accent: '#dc2626'
                    }
                }
            }
        }
    </script>
    
    <style>
        /* iOS-specific styles */
        body {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        /* Prevent zoom on input focus */
        input, select, textarea {
            font-size: 16px !important;
        }
        
        /* Better touch targets */
        button, input[type="checkbox"], input[type="radio"] {
            min-height: 44px;
            min-width: 44px;
            touch-action: manipulation;
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Hide scrollbars but keep functionality */
        .scrollable::-webkit-scrollbar {
            display: none;
        }
        .scrollable {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* PWA splash screen styles */
        .pwa-splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        
        .pwa-splash.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Loading animation */
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Safe area handling for iPhone */
        .safe-area-top {
            padding-top: env(safe-area-inset-top);
        }
        
        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        /* Improved mobile form styling */
        .mobile-form input, .mobile-form select, .mobile-form textarea {
            -webkit-appearance: none;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
            transition: all 0.2s ease;
        }
        
        .mobile-form input:focus, .mobile-form select:focus, .mobile-form textarea:focus {
            border-color: #1e40af;
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
            outline: none;
        }
        
        /* Better button styling for mobile */
        .mobile-btn {
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .mobile-btn:active {
            transform: translateY(1px);
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-400 via-pink-500 to-red-500 min-h-screen relative overflow-x-hidden safe-area-top safe-area-bottom">
    <!-- PWA Splash Screen -->
    <div id="pwaSplash" class="pwa-splash">
        <div class="text-center text-white">
            <div class="text-6xl mb-4">🚛</div>
            <h1 class="text-3xl font-bold mb-2">Truck Records</h1>
            <p class="text-lg opacity-90 mb-8">Loading your app...</p>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <!-- Animated background elements -->
    <div class="absolute inset-0 overflow-hidden">
        <div class="absolute -top-40 -right-40 w-80 h-80 bg-white opacity-10 rounded-full animate-pulse"></div>
        <div class="absolute top-40 -left-20 w-60 h-60 bg-yellow-300 opacity-20 rounded-full animate-bounce" style="animation-duration: 3s;"></div>
        <div class="absolute bottom-20 right-20 w-40 h-40 bg-blue-300 opacity-15 rounded-full animate-ping" style="animation-duration: 2s;"></div>
        <div class="absolute top-1/2 left-1/4 w-32 h-32 bg-green-300 opacity-10 rounded-full animate-pulse" style="animation-delay: 1s;"></div>
    </div>
    
    <div class="container mx-auto px-4 py-8 relative z-10">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-2 drop-shadow-lg">🚛 Truck Record System</h1>
            <p class="text-white/90 drop-shadow-md">Manage truck arrivals and carrier information</p>
        </div>

        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Form Section -->
            <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border border-white/20 mobile-form">
                <!-- Record Type Tabs -->
                <div class="flex space-x-1 mb-6 bg-gray-100 rounded-lg p-1">
                    <button type="button" onclick="switchRecordType('truck')" id="truckTab" class="flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors bg-primary text-white mobile-btn">
                        Truck Record
                    </button>
                    <button type="button" onclick="switchRecordType('handover')" id="handoverTab" class="flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-800 mobile-btn">
                        Handover Note
                    </button>
                    <button type="button" onclick="switchRecordType('xdock')" id="xdockTab" class="flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-800 mobile-btn">
                        XDOCK Record
                    </button>
                    <button type="button" onclick="switchRecordType('viewall')" id="viewallTab" class="flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-800 mobile-btn">
                        View All
                    </button>
                </div>

                <!-- Truck Record Form -->
                <div id="truckRecordForm">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Add New Truck Record</h2>
                    <form id="truckForm" class="space-y-6">
                    <!-- Basic Information -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Basic Information</h3>
                        
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-medium mb-2">Truck Arrival Time</label>
                                <input type="time" id="arrivalTime" step="1" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-gray-700 font-medium mb-2">Truck Temperature (°F)</label>
                                <input type="number" id="truckTemp" placeholder="e.g., 35" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                            </div>
                        </div>
                    </div>

                    <!-- Carrier Selection -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Select Carrier</h3>
                        
                        <div class="space-y-3">
                            <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-100 transition-colors">
                                <input type="checkbox" name="carrier" value="newtech" onchange="handleCarrierChange()" class="w-6 h-6 text-primary rounded focus:ring-primary">
                                <span class="text-gray-700 font-medium text-lg">NewTech</span>
                            </label>
                            <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-100 transition-colors">
                                <input type="checkbox" name="carrier" value="youfoodzs" onchange="handleCarrierChange()" class="w-6 h-6 text-primary rounded focus:ring-primary">
                                <span class="text-gray-700 font-medium text-lg">YouFoodz</span>
                            </label>
                            <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-100 transition-colors">
                                <input type="checkbox" name="carrier" value="other" onchange="handleCarrierChange()" class="w-6 h-6 text-primary rounded focus:ring-primary">
                                <span class="text-gray-700 font-medium text-lg">Other Carrier</span>
                            </label>
                        </div>
                    </div>

                    <!-- Dynamic Carrier Fields -->
                    <div id="carrierFields" class="space-y-4"></div>

                    <!-- Action Buttons -->
                    <div class="flex space-x-4 pt-4">
                        <button type="submit" class="flex-1 bg-primary hover:bg-primary/90 text-white font-bold py-4 px-6 rounded-lg transition-colors mobile-btn">
                            Add Record
                        </button>
                        <button type="button" onclick="clearForm()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-4 px-6 rounded-lg transition-colors mobile-btn">
                            Clear Form
                        </button>
                    </div>
                </form>
                </div>

                <!-- Handover Note Form -->
                <div id="handoverRecordForm" class="hidden">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Handover Note</h2>
                    <form id="handoverForm" class="space-y-6">
                        <!-- Truck Selection -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <label class="block text-gray-700 font-medium mb-3">Select Truck</label>
                            <div class="space-y-3">
                                <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-100 transition-colors">
                                    <input type="checkbox" name="handoverTruck" value="newtech" onchange="handleHandoverTruckChange()" class="w-6 h-6 text-primary rounded focus:ring-primary">
                                    <span class="text-gray-700 font-medium text-lg">NewTech</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-100 transition-colors">
                                    <input type="checkbox" name="handoverTruck" value="gibbins" onchange="handleHandoverTruckChange()" class="w-6 h-6 text-primary rounded focus:ring-primary">
                                    <span class="text-gray-700 font-medium text-lg">Gibbins</span>
                                </label>
                            </div>
                        </div>

                        <!-- ETA -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <label class="block text-gray-700 font-medium mb-2">ETA Time</label>
                            <input type="time" id="handoverETA" step="1" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex space-x-4 pt-4">
                            <button type="submit" class="flex-1 bg-primary hover:bg-primary/90 text-white font-bold py-4 px-6 rounded-lg transition-colors mobile-btn">
                                Add Handover Note
                            </button>
                            <button type="button" onclick="clearHandoverForm()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-4 px-6 rounded-lg transition-colors mobile-btn">
                                Clear Form
                            </button>
                        </div>
                    </form>
                </div>

                <!-- XDOCK Record Form -->
                <div id="xdockRecordForm" class="hidden">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">XDOCK Record</h2>
                    <form id="xdockForm" class="space-y-6">
                        <!-- XDOCK Information -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">XDOCK Details</h3>
                            
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">SFD</label>
                                    <select id="xdockSFD" onchange="handleSFDChange()" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="">Select SFD</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">FTG</label>
                                    <select id="xdockFTG" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="">Select FTG</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- SFD Name Field (appears when SFD is selected) -->
                            <div id="sfdNameField" class="hidden">
                                <label class="block text-gray-700 font-medium mb-2">SFD Name (Optional)</label>
                                <input type="text" id="xdockSFDName" placeholder="Enter name for this SFD..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                            </div>
                        </div>

                        <!-- Additional Information -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">Additional Information</h3>
                            
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Other</label>
                                    <textarea id="xdockOther" rows="3" placeholder="Enter additional information..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent resize-none"></textarea>
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Number of Runs</label>
                                    <select id="xdockRuns" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="">Select number of runs</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex space-x-4 pt-4">
                            <button type="submit" class="flex-1 bg-primary hover:bg-primary/90 text-white font-bold py-4 px-6 rounded-lg transition-colors mobile-btn">
                                Add XDOCK Record
                            </button>
                            <button type="button" onclick="clearXdockForm()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-4 px-6 rounded-lg transition-colors mobile-btn">
                                Clear Form
                            </button>
                        </div>
                    </form>
                </div>

                <!-- View All Records Form -->
                <div id="viewallRecordForm" class="hidden">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">All Records Summary</h2>
                    
                    <div class="bg-gray-50 rounded-lg p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-gray-700">Complete Records Report</h3>
                            <button onclick="copyAllRecordsToClipboard()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition-colors mobile-btn">
                                📋 Copy to Clipboard
                            </button>
                        </div>
                        
                        <div id="allRecordsText" class="bg-white p-4 rounded border border-gray-200 font-mono text-sm whitespace-pre-wrap max-h-96 overflow-y-auto scrollable">
                            <!-- All records will be displayed here -->
                        </div>
                        
                        <div class="mt-4 text-sm text-gray-600">
                            <p>💡 <strong>Tip:</strong> Click "Copy to Clipboard" to copy all records, then paste directly into WhatsApp or any messaging app!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Records Section -->
            <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border border-white/20">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Truck Records</h2>
                    <div class="flex space-x-2">
                        <button onclick="exportToPDF()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition-colors touch-manipulation min-h-[48px] mobile-btn">
                            📄 Export PDF
                        </button>
                        <button onclick="clearAllRecords()" class="bg-accent hover:bg-accent/90 text-white font-bold py-3 px-4 rounded-lg transition-colors touch-manipulation min-h-[48px] mobile-btn">
                            Clear All
                        </button>
                    </div>
                </div>
                
                <div id="recordsList" class="space-y-4 max-h-96 overflow-y-auto scrollable">
                    <div class="text-center text-gray-500 py-8">
                        No records yet. Add your first truck record!
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white/95 backdrop-blur-md rounded-2xl p-8 max-w-md w-full max-h-96 overflow-y-auto shadow-2xl border border-white/30 scrollable mobile-form">
            <h3 class="text-xl font-bold text-gray-800 mb-4">Edit Record</h3>
            <div id="editForm"></div>
            <div class="flex space-x-4 mt-6">
                <button onclick="saveEdit()" class="flex-1 bg-secondary hover:bg-secondary/90 text-white font-bold py-3 px-4 rounded-lg transition-colors mobile-btn">
                    Save Changes
                </button>
                <button onclick="closeEditModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-lg transition-colors mobile-btn">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Install Prompt -->
    <div id="installPrompt" class="fixed bottom-4 left-4 right-4 bg-primary text-white p-4 rounded-lg shadow-lg hidden z-50">
        <div class="flex items-center justify-between">
            <div>
                <h4 class="font-bold">Install Truck Records App</h4>
                <p class="text-sm opacity-90">Add to your home screen for quick access!</p>
            </div>
            <div class="flex space-x-2">
                <button onclick="installApp()" class="bg-white text-primary px-4 py-2 rounded font-medium mobile-btn">
                    Install
                </button>
                <button onclick="dismissInstall()" class="text-white/80 px-2 mobile-btn">
                    ✕
                </button>
            </div>
        </div>
    </div>

    <script>
        let records = [];
        let handoverRecords = [];
        let xdockRecords = [];
        let editingIndex = -1;
        let currentRecordType = 'truck';
        let deferredPrompt;

        // PWA Installation
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installPrompt').classList.remove('hidden');
        });

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    }
                    deferredPrompt = null;
                    document.getElementById('installPrompt').classList.add('hidden');
                });
            }
        }

        function dismissInstall() {
            document.getElementById('installPrompt').classList.add('hidden');
        }

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swCode = `
                    const CACHE_NAME = 'truck-records-v1';
                    const urlsToCache = [
                        './',
                        'https://cdn.tailwindcss.com',
                        'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js'
                    ];

                    self.addEventListener('install', (event) => {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then((cache) => cache.addAll(urlsToCache))
                        );
                    });

                    self.addEventListener('fetch', (event) => {
                        event.respondWith(
                            caches.match(event.request)
                                .then((response) => {
                                    if (response) {
                                        return response;
                                    }
                                    return fetch(event.request);
                                })
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl)
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // Hide splash screen after loading
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('pwaSplash').classList.add('hidden');
            }, 1500);
        });

        // Load data from localStorage
        function loadData() {
            const savedRecords = localStorage.getItem('truckRecords');
            const savedHandoverRecords = localStorage.getItem('handoverRecords');
            const savedXdockRecords = localStorage.getItem('xdockRecords');
            
            if (savedRecords) records = JSON.parse(savedRecords);
            if (savedHandoverRecords) handoverRecords = JSON.parse(savedHandoverRecords);
            if (savedXdockRecords) xdockRecords = JSON.parse(savedXdockRecords);
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('truckRecords', JSON.stringify(records));
            localStorage.setItem('handoverRecords', JSON.stringify(handoverRecords));
            localStorage.setItem('xdockRecords', JSON.stringify(xdockRecords));
        }

        // Handle SFD selection change
        function handleSFDChange() {
            const sfdSelect = document.getElementById('xdockSFD');
            const sfdNameField = document.getElementById('sfdNameField');
            
            if (sfdSelect.value) {
                sfdNameField.classList.remove('hidden');
            } else {
                sfdNameField.classList.add('hidden');
                document.getElementById('xdockSFDName').value = '';
            }
        }

        // Initialize dropdown options
        function initializeDropdowns() {
            // Initialize SFD dropdown (0-20)
            const sfdSelect = document.getElementById('xdockSFD');
            if (sfdSelect) {
                for (let i = 0; i <= 20; i++) {
                    sfdSelect.innerHTML += `<option value="${i}">${i}</option>`;
                }
            }

            // Initialize FTG dropdown (0-20)
            const ftgSelect = document.getElementById('xdockFTG');
            if (ftgSelect) {
                for (let i = 0; i <= 20; i++) {
                    ftgSelect.innerHTML += `<option value="${i}">${i}</option>`;
                }
            }

            // Initialize Runs dropdown (0-100)
            const runsSelect = document.getElementById('xdockRuns');
            if (runsSelect) {
                for (let i = 0; i <= 100; i++) {
                    runsSelect.innerHTML += `<option value="${i}">${i}</option>`;
                }
            }
        }

        // Switch between record types
        function switchRecordType(type) {
            currentRecordType = type;
            
            // Hide all forms
            document.getElementById('truckRecordForm').classList.add('hidden');
            document.getElementById('handoverRecordForm').classList.add('hidden');
            document.getElementById('xdockRecordForm').classList.add('hidden');
            document.getElementById('viewallRecordForm').classList.add('hidden');
            
            // Reset all tab styles
            document.getElementById('truckTab').className = 'flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-800 mobile-btn';
            document.getElementById('handoverTab').className = 'flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-800 mobile-btn';
            document.getElementById('xdockTab').className = 'flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-800 mobile-btn';
            document.getElementById('viewallTab').className = 'flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-800 mobile-btn';
            
            // Show selected form and activate tab
            if (type === 'truck') {
                document.getElementById('truckRecordForm').classList.remove('hidden');
                document.getElementById('truckTab').className = 'flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors bg-primary text-white mobile-btn';
            } else if (type === 'handover') {
                document.getElementById('handoverRecordForm').classList.remove('hidden');
                document.getElementById('handoverTab').className = 'flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors bg-primary text-white mobile-btn';
            } else if (type === 'xdock') {
                document.getElementById('xdockRecordForm').classList.remove('hidden');
                document.getElementById('xdockTab').className = 'flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors bg-primary text-white mobile-btn';
                initializeDropdowns();
            } else if (type === 'viewall') {
                document.getElementById('viewallRecordForm').classList.remove('hidden');
                document.getElementById('viewallTab').className = 'flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors bg-primary text-white mobile-btn';
                updateAllRecordsDisplay();
            }
            
            displayRecords();
        }

        // Handle handover truck selection
        function handleHandoverTruckChange() {
            const checkboxes = document.querySelectorAll('input[name="handoverTruck"]');
            
            // Allow only one truck to be selected
            checkboxes.forEach(checkbox => {
                if (checkbox !== event.target) {
                    checkbox.checked = false;
                }
            });
        }

        function updatePalletOptions() {
            const locationSelect = document.getElementById('youfoodzBoxLocation');
            const palletSelect = document.getElementById('youfoodzPallets');
            const selectedLocation = locationSelect.value;
            
            palletSelect.innerHTML = '';
            
            if (selectedLocation === 'BDB' || selectedLocation === 'CNS' || selectedLocation === 'TSV') {
                palletSelect.innerHTML = '<option value="">Select number of pallets</option>';
                for (let i = 0; i <= 10; i++) {
                    palletSelect.innerHTML += `<option value="${i}">${i}</option>`;
                }
            } else if (selectedLocation === 'QLD') {
                palletSelect.innerHTML = '<option value="">Select number of pallets</option>';
                for (let i = 1; i <= 50; i++) {
                    palletSelect.innerHTML += `<option value="${i}">${i}</option>`;
                }
            } else {
                palletSelect.innerHTML = '<option value="">Select location first</option>';
            }
        }

        function handleCarrierChange() {
            const checkboxes = document.querySelectorAll('input[name="carrier"]');
            const carrierFields = document.getElementById('carrierFields');
            
            // Allow only one carrier to be selected
            checkboxes.forEach(checkbox => {
                if (checkbox !== event.target) {
                    checkbox.checked = false;
                }
            });

            const selectedCarrier = event.target.checked ? event.target.value : null;
            carrierFields.innerHTML = '';

            if (selectedCarrier === 'newtech') {
                carrierFields.innerHTML = `
                    <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                        <h4 class="text-lg font-semibold text-blue-800 mb-3">NewTech Details</h4>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Number of Pallets</label>
                            <input type="number" id="pallets" placeholder="e.g., 12" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>
                    </div>
                `;
            } else if (selectedCarrier === 'youfoodzs') {
                carrierFields.innerHTML = `
                    <div class="bg-green-50 rounded-lg p-4 border border-green-200">
                        <h4 class="text-lg font-semibold text-green-800 mb-3">YouFoodz Details</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 font-medium mb-2">Location of Box</label>
                                <select id="youfoodzBoxLocation" onchange="updatePalletOptions()" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <option value="">Select Location</option>
                                    <option value="BDB">BDB</option>
                                    <option value="CNS">CNS</option>
                                    <option value="TSV">TSV</option>
                                    <option value="QLD">QLD</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 font-medium mb-2">Number of Pallets</label>
                                <select id="youfoodzPallets" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <option value="">Select location first</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 font-medium mb-3">7/11 Option</label>
                                <div class="flex space-x-6">
                                    <label class="flex items-center space-x-2 cursor-pointer p-2 rounded-lg hover:bg-gray-100 transition-colors">
                                        <input type="radio" name="option711" value="yes" class="w-5 h-5 text-primary focus:ring-primary">
                                        <span class="text-gray-700 text-lg">Yes</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer p-2 rounded-lg hover:bg-gray-100 transition-colors">
                                        <input type="radio" name="option711" value="no" class="w-5 h-5 text-primary focus:ring-primary">
                                        <span class="text-gray-700 text-lg">No</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (selectedCarrier === 'other') {
                carrierFields.innerHTML = `
                    <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                        <h4 class="text-lg font-semibold text-purple-800 mb-3">Other Carrier Details</h4>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Carrier Name</label>
                            <input type="text" id="otherCarrierName" placeholder="Enter carrier name" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>
                    </div>
                `;
            }
        }

        function clearForm() {
            document.getElementById('truckForm').reset();
            document.getElementById('carrierFields').innerHTML = '';
        }

        function clearHandoverForm() {
            document.getElementById('handoverForm').reset();
        }

        function clearXdockForm() {
            document.getElementById('xdockForm').reset();
            document.getElementById('sfdNameField').classList.add('hidden');
        }

        // Add handover record
        function addHandoverRecord(event) {
            event.preventDefault();
            
            const selectedTruck = document.querySelector('input[name="handoverTruck"]:checked');
            const eta = document.getElementById('handoverETA').value;
            
            if (!selectedTruck) {
                alert('Please select a truck');
                return;
            }

            const record = {
                id: Date.now(),
                type: 'handover',
                truck: selectedTruck.value,
                eta: eta,
                timestamp: new Date().toLocaleString()
            };

            handoverRecords.push(record);
            saveData();
            displayRecords();
            clearHandoverForm();
            
            // Haptic feedback on mobile
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        // Add XDOCK record
        function addXdockRecord(event) {
            event.preventDefault();
            
            const sfd = document.getElementById('xdockSFD').value;
            const sfdName = document.getElementById('xdockSFDName').value;
            const ftg = document.getElementById('xdockFTG').value;
            const other = document.getElementById('xdockOther').value;
            const runs = document.getElementById('xdockRuns').value;

            const record = {
                id: Date.now(),
                type: 'xdock',
                sfd: sfd,
                sfdName: sfdName,
                ftg: ftg,
                other: other,
                runs: runs,
                timestamp: new Date().toLocaleString()
            };

            xdockRecords.push(record);
            saveData();
            displayRecords();
            clearXdockForm();
            
            // Haptic feedback on mobile
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        function addRecord(event) {
            event.preventDefault();
            
            const arrivalTime = document.getElementById('arrivalTime').value;
            const truckTemp = document.getElementById('truckTemp').value;
            const selectedCarrier = document.querySelector('input[name="carrier"]:checked');
            
            if (!selectedCarrier) {
                alert('Please select a carrier');
                return;
            }

            const record = {
                id: Date.now(),
                arrivalTime,
                truckTemp,
                carrier: selectedCarrier.value,
                timestamp: new Date().toLocaleString()
            };

            // Add carrier-specific data
            if (selectedCarrier.value === 'newtech') {
                record.pallets = document.getElementById('pallets').value;
            } else if (selectedCarrier.value === 'youfoodzs') {
                record.youfoodzBoxLocation = document.getElementById('youfoodzBoxLocation').value;
                record.youfoodzPallets = document.getElementById('youfoodzPallets').value;
                record.option711 = document.querySelector('input[name="option711"]:checked')?.value || 'Not specified';
            } else if (selectedCarrier.value === 'other') {
                record.otherCarrierName = document.getElementById('otherCarrierName').value;
            }

            records.push(record);
            saveData();
            displayRecords();
            clearForm();
            
            // Haptic feedback on mobile
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        function displayRecords() {
            const recordsList = document.getElementById('recordsList');
            let currentRecords = [];
            let recordType = '';
            
            if (currentRecordType === 'truck') {
                currentRecords = records;
                recordType = 'truck records';
            } else if (currentRecordType === 'handover') {
                currentRecords = handoverRecords;
                recordType = 'handover notes';
            } else if (currentRecordType === 'xdock') {
                currentRecords = xdockRecords;
                recordType = 'XDOCK records';
            }
            
            if (currentRecords.length === 0) {
                recordsList.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        No ${recordType} yet. Add your first record!
                    </div>
                `;
                return;
            }

            recordsList.innerHTML = currentRecords.map((record, index) => {
                if (currentRecordType === 'truck') {
                    return `
                        <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                            <div class="flex justify-between items-start mb-3">
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800 capitalize">${record.carrier} Carrier</h4>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="editRecord(${index})" class="bg-secondary hover:bg-secondary/90 text-white px-4 py-3 rounded text-sm transition-colors touch-manipulation min-h-[44px] min-w-[60px] mobile-btn">
                                        Edit
                                    </button>
                                    <button onclick="deleteRecord(${index})" class="bg-accent hover:bg-accent/90 text-white px-4 py-3 rounded text-sm transition-colors touch-manipulation min-h-[44px] min-w-[60px] mobile-btn">
                                        Delete
                                    </button>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-2 text-sm">
                                <div><strong>Arrival:</strong> ${record.arrivalTime}</div>
                                <div><strong>Temperature:</strong> ${record.truckTemp}°F</div>
                                ${record.pallets ? `<div><strong>Pallets:</strong> ${record.pallets}</div>` : ''}
                                ${record.youfoodzBoxLocation ? `<div><strong>YouFoodz Box Location:</strong> ${record.youfoodzBoxLocation}</div>` : ''}
                                ${record.youfoodzPallets ? `<div><strong>YouFoodz Pallets:</strong> ${record.youfoodzPallets}</div>` : ''}
                                ${record.option711 ? `<div><strong>7/11:</strong> ${record.option711}</div>` : ''}
                                ${record.otherCarrierName ? `<div><strong>Carrier Name:</strong> ${record.otherCarrierName}</div>` : ''}
                            </div>
                        </div>
                    `;
                } else if (currentRecordType === 'handover') {
                    return `
                        <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                            <div class="flex justify-between items-start mb-3">
                                <div class="flex-1">
                                    <h4 class="font-semibold text-blue-800 capitalize">${record.truck} Handover</h4>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="editRecord(${index})" class="bg-secondary hover:bg-secondary/90 text-white px-4 py-3 rounded text-sm transition-colors touch-manipulation min-h-[44px] min-w-[60px] mobile-btn">
                                        Edit
                                    </button>
                                    <button onclick="deleteRecord(${index})" class="bg-accent hover:bg-accent/90 text-white px-4 py-3 rounded text-sm transition-colors touch-manipulation min-h-[44px] min-w-[60px] mobile-btn">
                                        Delete
                                    </button>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-2 text-sm">
                                <div><strong>Truck:</strong> ${record.truck}</div>
                                <div><strong>ETA:</strong> ${record.eta}</div>
                            </div>
                        </div>
                    `;
                } else if (currentRecordType === 'xdock') {
                    return `
                        <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                            <div class="flex justify-between items-start mb-3">
                                <div class="flex-1">
                                    <h4 class="font-semibold text-purple-800">XDOCK Record</h4>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="editRecord(${index})" class="bg-secondary hover:bg-secondary/90 text-white px-4 py-3 rounded text-sm transition-colors touch-manipulation min-h-[44px] min-w-[60px] mobile-btn">
                                        Edit
                                    </button>
                                    <button onclick="deleteRecord(${index})" class="bg-accent hover:bg-accent/90 text-white px-4 py-3 rounded text-sm transition-colors touch-manipulation min-h-[44px] min-w-[60px] mobile-btn">
                                        Delete
                                    </button>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-2 text-sm">
                                <div><strong>SFD:</strong> ${record.sfd}${record.sfdName ? ` (${record.sfdName})` : ''}</div>
                                <div><strong>FTG:</strong> ${record.ftg}</div>
                                <div><strong>Runs:</strong> ${record.runs}</div>
                                ${record.other ? `<div><strong>Other:</strong> ${record.other}</div>` : ''}
                            </div>
                        </div>
                    `;
                }
            }).join('');
        }

        function editRecord(index) {
            editingIndex = index;
            const modal = document.getElementById('editModal');
            const editForm = document.getElementById('editForm');
            
            let record;
            if (currentRecordType === 'truck') {
                record = records[index];
            } else if (currentRecordType === 'handover') {
                record = handoverRecords[index];
            } else if (currentRecordType === 'xdock') {
                record = xdockRecords[index];
            }
            
            if (currentRecordType === 'handover') {
                editForm.innerHTML = `
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">Truck</label>
                        <div class="space-y-2">
                            <label class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer">
                                <input type="radio" name="editHandoverTruck" value="newtech" ${record.truck === 'newtech' ? 'checked' : ''} class="w-5 h-5 text-primary focus:ring-primary">
                                <span class="text-lg">NewTech</span>
                            </label>
                            <label class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer">
                                <input type="radio" name="editHandoverTruck" value="gibbins" ${record.truck === 'gibbins' ? 'checked' : ''} class="w-5 h-5 text-primary focus:ring-primary">
                                <span class="text-lg">Gibbins</span>
                            </label>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">ETA Time</label>
                        <input type="time" id="editHandoverETA" step="1" value="${record.eta}" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                    </div>
                `;
                
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                return;
            }
            
            if (currentRecordType === 'xdock') {
                // Generate SFD options
                let sfdOptions = '<option value="">Select SFD</option>';
                for (let i = 0; i <= 20; i++) {
                    const selected = record.sfd == i ? 'selected' : '';
                    sfdOptions += `<option value="${i}" ${selected}>${i}</option>`;
                }
                
                // Generate FTG options
                let ftgOptions = '<option value="">Select FTG</option>';
                for (let i = 0; i <= 20; i++) {
                    const selected = record.ftg == i ? 'selected' : '';
                    ftgOptions += `<option value="${i}" ${selected}>${i}</option>`;
                }
                
                // Generate Runs options
                let runsOptions = '<option value="">Select number of runs</option>';
                for (let i = 0; i <= 100; i++) {
                    const selected = record.runs == i ? 'selected' : '';
                    runsOptions += `<option value="${i}" ${selected}>${i}</option>`;
                }
                
                editForm.innerHTML = `
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">SFD</label>
                        <select id="editXdockSFD" onchange="handleEditSFDChange()" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                            ${sfdOptions}
                        </select>
                    </div>
                    <div id="editSfdNameField" class="${record.sfd ? '' : 'hidden'} mb-4">
                        <label class="block text-gray-700 font-medium mb-2">SFD Name (Optional)</label>
                        <input type="text" id="editXdockSFDName" value="${record.sfdName || ''}" placeholder="Enter name for this SFD..." class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">FTG</label>
                        <select id="editXdockFTG" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                            ${ftgOptions}
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">Other</label>
                        <textarea id="editXdockOther" rows="3" placeholder="Enter additional information..." class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent resize-none">${record.other || ''}</textarea>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">Number of Runs</label>
                        <select id="editXdockRuns" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                            ${runsOptions}
                        </select>
                    </div>
                `;
                
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                return;
            }
            
            let carrierSpecificFields = '';
            if (record.carrier === 'newtech') {
                carrierSpecificFields = `
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">Number of Pallets</label>
                        <input type="number" id="editPallets" value="${record.pallets || ''}" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                    </div>
                `;
            } else if (record.carrier === 'youfoodzs') {
                carrierSpecificFields = `
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">YouFoodz Box Location</label>
                        <select id="editYoufoodzBoxLocation" onchange="updateEditPalletOptions()" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                            <option value="">Select Location</option>
                            <option value="BDB" ${record.youfoodzBoxLocation === 'BDB' ? 'selected' : ''}>BDB</option>
                            <option value="CNS" ${record.youfoodzBoxLocation === 'CNS' ? 'selected' : ''}>CNS</option>
                            <option value="TSV" ${record.youfoodzBoxLocation === 'TSV' ? 'selected' : ''}>TSV</option>
                            <option value="QLD" ${record.youfoodzBoxLocation === 'QLD' ? 'selected' : ''}>QLD</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">Number of Pallets</label>
                        <select id="editYoufoodzPallets" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                            <option value="">Select location first</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">7/11 Option</label>
                        <div class="flex space-x-4">
                            <label class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer">
                                <input type="radio" name="editOption711" value="yes" ${record.option711 === 'yes' ? 'checked' : ''} class="w-5 h-5 text-primary focus:ring-primary">
                                <span class="text-lg">Yes</span>
                            </label>
                            <label class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer">
                                <input type="radio" name="editOption711" value="no" ${record.option711 === 'no' ? 'checked' : ''} class="w-5 h-5 text-primary focus:ring-primary">
                                <span class="text-lg">No</span>
                            </label>
                        </div>
                    </div>
                `;
            } else if (record.carrier === 'other') {
                carrierSpecificFields = `
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">Carrier Name</label>
                        <input type="text" id="editOtherCarrierName" value="${record.otherCarrierName || ''}" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                    </div>
                `;
            }

            editForm.innerHTML = `
                <div class="mb-4">
                    <label class="block text-gray-700 font-medium mb-2">Arrival Time</label>
                    <input type="time" id="editArrivalTime" step="1" value="${record.arrivalTime}" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 font-medium mb-2">Temperature (°F)</label>
                    <input type="number" id="editTruckTemp" value="${record.truckTemp}" class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>
                ${carrierSpecificFields}
            `;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            // Update pallet options for edit modal if YouFoodz
            if (record.carrier === 'youfoodzs') {
                setTimeout(() => updateEditPalletOptions(record.youfoodzPallets), 100);
            }
        }

        function updateEditPalletOptions(selectedPallet = null) {
            const locationSelect = document.getElementById('editYoufoodzBoxLocation');
            const palletSelect = document.getElementById('editYoufoodzPallets');
            const selectedLocation = locationSelect.value;
            
            palletSelect.innerHTML = '';
            
            if (selectedLocation === 'BDB' || selectedLocation === 'CNS' || selectedLocation === 'TSV') {
                palletSelect.innerHTML = '<option value="">Select number of pallets</option>';
                for (let i = 0; i <= 10; i++) {
                    const selected = selectedPallet == i ? 'selected' : '';
                    palletSelect.innerHTML += `<option value="${i}" ${selected}>${i}</option>`;
                }
            } else if (selectedLocation === 'QLD') {
                palletSelect.innerHTML = '<option value="">Select number of pallets</option>';
                for (let i = 1; i <= 50; i++) {
                    const selected = selectedPallet == i ? 'selected' : '';
                    palletSelect.innerHTML += `<option value="${i}" ${selected}>${i}</option>`;
                }
            } else {
                palletSelect.innerHTML = '<option value="">Select location first</option>';
            }
        }

        function saveEdit() {
            if (currentRecordType === 'truck') {
                const record = records[editingIndex];
                
                record.arrivalTime = document.getElementById('editArrivalTime').value;
                record.truckTemp = document.getElementById('editTruckTemp').value;
                
                if (record.carrier === 'newtech') {
                    record.pallets = document.getElementById('editPallets').value;
                } else if (record.carrier === 'youfoodzs') {
                    record.youfoodzBoxLocation = document.getElementById('editYoufoodzBoxLocation').value;
                    record.youfoodzPallets = document.getElementById('editYoufoodzPallets').value;
                    record.option711 = document.querySelector('input[name="editOption711"]:checked')?.value || 'Not specified';
                } else if (record.carrier === 'other') {
                    record.otherCarrierName = document.getElementById('editOtherCarrierName').value;
                }
            } else if (currentRecordType === 'handover') {
                const record = handoverRecords[editingIndex];
                
                const selectedTruck = document.querySelector('input[name="editHandoverTruck"]:checked');
                if (selectedTruck) {
                    record.truck = selectedTruck.value;
                }
                record.eta = document.getElementById('editHandoverETA').value;
            } else if (currentRecordType === 'xdock') {
                const record = xdockRecords[editingIndex];
                
                record.sfd = document.getElementById('editXdockSFD').value;
                record.sfdName = document.getElementById('editXdockSFDName').value;
                record.ftg = document.getElementById('editXdockFTG').value;
                record.other = document.getElementById('editXdockOther').value;
                record.runs = document.getElementById('editXdockRuns').value;
            }
            
            saveData();
            displayRecords();
            closeEditModal();
            
            // Haptic feedback on mobile
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.add('hidden');
            document.getElementById('editModal').classList.remove('flex');
            editingIndex = -1;
        }

        function deleteRecord(index) {
            // Prevent default behavior and stop propagation
            event.preventDefault();
            event.stopPropagation();
            
            const userConfirmed = confirm('Are you sure you want to delete this record?\n\nThis action cannot be undone.');
            
            if (userConfirmed) {
                if (currentRecordType === 'truck') {
                    records.splice(index, 1);
                } else if (currentRecordType === 'handover') {
                    handoverRecords.splice(index, 1);
                } else if (currentRecordType === 'xdock') {
                    xdockRecords.splice(index, 1);
                }
                saveData();
                displayRecords();
                updateAllRecordsDisplay();
                
                // Haptic feedback on mobile
                if (navigator.vibrate) {
                    navigator.vibrate([50, 50, 50]);
                }
                
                // Show success message
                setTimeout(() => {
                    alert('✅ Record deleted successfully!');
                }, 100);
            }
        }

        function handleEditSFDChange() {
            const sfdSelect = document.getElementById('editXdockSFD');
            const sfdNameField = document.getElementById('editSfdNameField');
            
            if (sfdSelect.value) {
                sfdNameField.classList.remove('hidden');
            } else {
                sfdNameField.classList.add('hidden');
                document.getElementById('editXdockSFDName').value = '';
            }
        }

        function clearAllRecords() {
            // Prevent default behavior and stop propagation
            event.preventDefault();
            event.stopPropagation();
            
            let recordTypeName = '';
            if (currentRecordType === 'truck') {
                recordTypeName = 'truck records';
            } else if (currentRecordType === 'handover') {
                recordTypeName = 'handover notes';
            } else if (currentRecordType === 'xdock') {
                recordTypeName = 'XDOCK records';
            }
            
            // Use a more mobile-friendly confirmation
            const userConfirmed = confirm(`Are you sure you want to clear all ${recordTypeName}?\n\nThis action cannot be undone.`);
            
            if (userConfirmed) {
                if (currentRecordType === 'truck') {
                    records.length = 0;
                } else if (currentRecordType === 'handover') {
                    handoverRecords.length = 0;
                } else if (currentRecordType === 'xdock') {
                    xdockRecords.length = 0;
                }
                saveData();
                displayRecords();
                updateAllRecordsDisplay();
                
                // Haptic feedback on mobile
                if (navigator.vibrate) {
                    navigator.vibrate([100, 50, 100]);
                }
                
                // Show success message
                setTimeout(() => {
                    alert(`✅ All ${recordTypeName} have been cleared!`);
                }, 100);
            }
        }

        // Generate all records text content
        function generateAllRecordsText() {
            let content = '🚛 TRUCK RECORD SYSTEM REPORT\n';
            content += '=================================\n';
            content += `📅 Generated: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}\n\n`;
            
            // Add truck records
            if (records.length > 0) {
                content += '📦 TRUCK RECORDS:\n';
                content += '─────────────────\n';
                records.forEach((record, index) => {
                    content += `${index + 1}. ${record.carrier.toUpperCase()} CARRIER\n`;
                    content += `   🕐 Arrival: ${record.arrivalTime}\n`;
                    content += `   🌡️ Temperature: ${record.truckTemp}°F\n`;
                    if (record.pallets) content += `   📦 Pallets: ${record.pallets}\n`;
                    if (record.youfoodzBoxLocation) {
                        content += `   📍 YouFoodz Location: ${record.youfoodzBoxLocation}\n`;
                        content += `   📦 YouFoodz Pallets: ${record.youfoodzPallets}\n`;
                        content += `   🏪 7/11 Option: ${record.option711}\n`;
                    }
                    if (record.otherCarrierName) content += `   🚚 Carrier Name: ${record.otherCarrierName}\n`;
                    content += `\n`;
                });
            }
            
            // Add handover records
            if (handoverRecords.length > 0) {
                content += '🤝 HANDOVER NOTES:\n';
                content += '──────────────────\n';
                handoverRecords.forEach((record, index) => {
                    content += `${index + 1}. ${record.truck.toUpperCase()} HANDOVER\n`;
                    content += `   🚛 Truck: ${record.truck}\n`;
                    content += `   🕐 ETA: ${record.eta}\n`;
                    content += `\n`;
                });
            }
            
            // Add XDOCK records
            if (xdockRecords.length > 0) {
                content += '🔄 XDOCK RECORDS:\n';
                content += '─────────────────\n';
                xdockRecords.forEach((record, index) => {
                    content += `${index + 1}. XDOCK RECORD\n`;
                    content += `   📊 SFD: ${record.sfd}${record.sfdName ? ` (${record.sfdName})` : ''}\n`;
                    content += `   📈 FTG: ${record.ftg}\n`;
                    content += `   🔢 Runs: ${record.runs}\n`;
                    if (record.other) content += `   📝 Other: ${record.other}\n`;
                    content += `\n`;
                });
            }
            
            // If no records exist
            if (records.length === 0 && handoverRecords.length === 0 && xdockRecords.length === 0) {
                content += '📝 No records found.\n';
                content += 'Add some records to see them here!\n\n';
            }
            
            content += '─────────────────────────────────\n';
            content += '📱 Ready to share on WhatsApp!\n';
            content += '💡 Just copy and paste this text.';
            
            return content;
        }

        // Update the all records display
        function updateAllRecordsDisplay() {
            const allRecordsText = document.getElementById('allRecordsText');
            if (allRecordsText) {
                allRecordsText.textContent = generateAllRecordsText();
            }
        }

        // Copy all records to clipboard
        function copyAllRecordsToClipboard() {
            const content = generateAllRecordsText();
            
            // Try to use the modern clipboard API
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(content).then(() => {
                    // Haptic feedback on mobile
                    if (navigator.vibrate) {
                        navigator.vibrate(100);
                    }
                    alert('✅ All records copied to clipboard!\n\nYou can now paste this directly into WhatsApp or any messaging app.');
                }).catch(() => {
                    // Fallback if clipboard API fails
                    fallbackCopyToClipboard(content);
                });
            } else {
                // Fallback for older browsers or non-secure contexts
                fallbackCopyToClipboard(content);
            }
        }

        // Fallback copy method
        function fallbackCopyToClipboard(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                // Haptic feedback on mobile
                if (navigator.vibrate) {
                    navigator.vibrate(100);
                }
                alert('✅ All records copied to clipboard!\n\nYou can now paste this directly into WhatsApp or any messaging app.');
            } catch (err) {
                alert('❌ Could not copy to clipboard. Please manually select and copy the text above.');
            }
            
            document.body.removeChild(textArea);
        }

        function exportToPDF() {
            // Simple text-based export that works without external libraries
            let content = 'TRUCK RECORD SYSTEM REPORT\n';
            content += '=================================\n';
            content += `Generated on: ${new Date().toLocaleDateString()}\n\n`;
            
            // Export current tab's records
            if (currentRecordType === 'truck' && records.length > 0) {
                content += 'TRUCK RECORDS:\n';
                content += '--------------\n';
                records.forEach((record, index) => {
                    content += `${index + 1}. ${record.carrier.toUpperCase()} CARRIER\n`;
                    content += `   Arrival: ${record.arrivalTime}\n`;
                    content += `   Temperature: ${record.truckTemp}°F\n`;
                    if (record.pallets) content += `   Pallets: ${record.pallets}\n`;
                    if (record.youfoodzBoxLocation) {
                        content += `   YouFoodz Location: ${record.youfoodzBoxLocation}\n`;
                        content += `   YouFoodz Pallets: ${record.youfoodzPallets}\n`;
                        content += `   7/11 Option: ${record.option711}\n`;
                    }
                    if (record.otherCarrierName) content += `   Carrier Name: ${record.otherCarrierName}\n`;
                    content += `   Added: ${record.timestamp}\n\n`;
                });
            } else if (currentRecordType === 'handover' && handoverRecords.length > 0) {
                content += 'HANDOVER NOTES:\n';
                content += '---------------\n';
                handoverRecords.forEach((record, index) => {
                    content += `${index + 1}. ${record.truck.toUpperCase()} HANDOVER\n`;
                    content += `   Truck: ${record.truck}\n`;
                    content += `   ETA: ${record.eta}\n`;
                    content += `   Added: ${record.timestamp}\n\n`;
                });
            } else if (currentRecordType === 'xdock' && xdockRecords.length > 0) {
                content += 'XDOCK RECORDS:\n';
                content += '--------------\n';
                xdockRecords.forEach((record, index) => {
                    content += `${index + 1}. XDOCK RECORD\n`;
                    content += `   SFD: ${record.sfd}${record.sfdName ? ` (${record.sfdName})` : ''}\n`;
                    content += `   FTG: ${record.ftg}\n`;
                    content += `   Runs: ${record.runs}\n`;
                    if (record.other) content += `   Other: ${record.other}\n`;
                    content += `   Added: ${record.timestamp}\n\n`;
                });
            } else {
                content += 'No records found to export.\n';
            }
            
            // Create and download the file
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `truck-records-${currentRecordType}-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            // Haptic feedback on mobile
            if (navigator.vibrate) {
                navigator.vibrate(100);
            }
            
            alert(`Records exported successfully!\n\nTo share on WhatsApp:\n1. Find the downloaded text file\n2. Open it and copy the content\n3. Paste into WhatsApp message`);
        }

        // Event listeners
        document.getElementById('truckForm').addEventListener('submit', addRecord);
        document.getElementById('handoverForm').addEventListener('submit', addHandoverRecord);
        document.getElementById('xdockForm').addEventListener('submit', addXdockRecord);

        // Initialize app
        loadData();
        displayRecords();
        updateAllRecordsDisplay();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9627ee64c6a5d718',t:'MTc1MzA3MTg5My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
